function TDControlHelper(a){function b(a){l.focus(),0!=a.buttons&&0==a.button&&(m=a.x,n=a.y,null!=s&&s(m,n),o=m,p=n,q=!0,a.preventDefault())}function c(a){if(0!=q&&0!=a.buttons&&0==a.button){m=a.x,n=a.y;var b=m-o,c=n-p;null!=r&&(0==b&&0==c||r(m,n,b,c)),o=m,p=n,a.preventDefault()}}function d(a){if(0!=q&&0==a.button){m=a.x,n=a.y;var b=m-o,c=n-p;null!=t&&t(m,n,b,c),o=m,p=n,q=!1,a.preventDefault()}}function e(a){l.focus(),1==a.touches.length&&(m=a.touches[0].clientX,n=a.touches[0].clientY,null!=s&&s(m,n),o=m,p=n,q=!0,a.preventDefault())}function f(a){if(0!=q&&1==a.touches.length){m=a.touches[0].clientX,n=a.touches[0].clientY;var b=m-o,c=n-p;null!=r&&(0==b&&0==c||r(m,n,b,c)),o=m,p=n,a.preventDefault()}}function g(a){if(0!=q&&1==a.touches.length){m=a.touches[0].clientX,n=a.touches[0].clientY;var b=m-o,c=n-p;null!=t&&t(m,n,b,c),o=m,p=n,q=!1,a.preventDefault()}}function h(a){0!=a.keyCode&&(null!=u&&u(a.keyCode),y[a.keyCode]=a,null==x&&(x=setInterval(i,w)),a.preventDefault())}function i(){null!=v&&v(y)}function j(a){0!=a.keyCode&&(null!=z&&z(a.keyCode),delete y[a.keyCode],null!=x&&0==Object.getOwnPropertyNames(y).length&&(clearInterval(x),x=null),a.preventDefault())}var l=a,m=0,n=0,o=0,p=0,q=!1,r=null,s=null,t=null,u=null,v=null,w=30,x=null,y={},z=null;l.setAttribute("tabindex","1"),this.setFunRefresh=function(a){r=a},this.getFunRefresh=function(){return r},this.setFunBegin=function(a){s=a},this.getFunBegin=function(){return s},this.setFunEnd=function(a){t=a},this.getFunEnd=function(){return t},this.setFunKeyDown=function(a){u=a},this.getFunKeyDown=function(){return u},this.setFunKeyHold=function(a,b){v=a,w=null!=b&&b>0?b:30},this.getFunKeyHold=function(){return v},this.setFunKeyUp=function(a){z=a},this.getFunKeyUp=function(){return z},l.addEventListener("mousedown",b,!0),l.addEventListener("mousemove",c,!0),l.addEventListener("mouseup",d,!0),l.addEventListener("mouseover",b,!0),l.addEventListener("mouseout",d,!0),l.addEventListener("touchstart",e,!0),l.addEventListener("touchmove",f,!0),l.addEventListener("touchend",g,!0),l.addEventListener("keydown",h,!0),l.addEventListener("keyup",j,!0),this.bindCamera=function(a){this.setFunRefresh(function(b,c,d,e){a.rotationViewMatrix(.1*d,.1*-e)}),this.setFunEnd(this.getFunRefresh()),this.setFunKeyHold(function(b){for(k in b){var c=b[k];37==c.keyCode||65==c.keyCode?a.moveViewMatrix(-1,0,0):39==c.keyCode||68==c.keyCode?a.moveViewMatrix(1,0,0):38==c.keyCode||87==c.keyCode?a.moveViewMatrix(0,0,1):40!=c.keyCode&&83!=c.keyCode||a.moveViewMatrix(0,0,-1)}})}}